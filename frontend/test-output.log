
> @orbitmesh/frontend@0.0.1 test
> vitest --reporter=verbose


 DEV  v1.6.1 /Users/matt/mycode/orbitmesh/frontend

 âœ“ src/api/client.test.ts > apiClient > listSessions fetches sessions successfully
 âœ“ src/api/client.test.ts > apiClient > createSession sends POST request with CSRF token
 âœ“ src/api/client.test.ts > apiClient > createTaskSession sends task metadata
 âœ“ src/api/client.test.ts > apiClient > getSession fetches single session
 âœ“ src/api/client.test.ts > apiClient > stopSession sends DELETE request with CSRF token
 âœ“ src/api/client.test.ts > apiClient > getPermissions fetches guardrail details
 âœ“ src/api/client.test.ts > apiClient > sanitizes guardrail guidance content
 âœ“ src/api/client.test.ts > apiClient > defaults missing guardrails to an empty array
 âœ“ src/api/client.test.ts > apiClient > throws error when response is not ok
 âœ“ src/api/client.test.ts > apiClient > prefers JSON error payloads when available
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Deep Linking > loads dashboard route without blank state
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Deep Linking > loads tasks route without blank state
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Deep Linking > loads sessions route without blank state
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Deep Linking > loads settings route without blank state
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Deep Linking > loads extractors route without blank state
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Deep Linking > handles deep links to nested routes (sessions with ID)
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Deep Linking > handles deep links to task details
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Keyboard Navigation > allows tabbing through sidebar links in order
 âœ“ src/views/SessionViewer.test.tsx > SessionViewer > renders initial output and streams new transcript messages
 âœ“ src/views/SessionViewer.test.tsx > SessionViewer > renders activity entry revisions without duplication
 âœ“ src/views/SessionViewer.test.tsx > SessionViewer > renders terminal when session provider is PTY
 âœ“ src/views/SessionViewer.test.tsx > SessionViewer > does not render raw output for PTY sessions
 âœ“ src/views/SessionViewer.test.tsx > SessionViewer > invokes pause and kill controls
 âœ“ src/views/SessionViewer.test.tsx > SessionViewer > calls onClose when close button is clicked
 âœ“ src/views/SessionViewer.test.tsx > SessionViewer > shows state-aware tooltips for disabled buttons
 âœ“ src/views/SessionViewer.test.tsx > SessionViewer > shows action-in-progress tooltips
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ basic rendering > renders an svg element with no props
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ basic rendering > renders with custom nodes and links
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ basic rendering > sets explicit width and height attributes on svg
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ basic rendering > renders with 100% width/height style for responsiveness
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ basic rendering > maintains viewBox for responsive scaling
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ basic rendering > renders correct number of circles for nodes
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ basic rendering > renders correct number of lines for links
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ basic rendering > renders text labels for each node
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ basic rendering > handles empty arrays gracefully
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ basic rendering > uses default nodes when none provided
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ selection > supports onSelect callback prop
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ selection > applies different radius to selected node
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ selection > applies thicker stroke to selected node
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ selection > applies bold font weight to selected node label
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ node colors > applies var(--graph-agent) fill to agent nodes
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ node colors > applies var(--graph-task) fill to task nodes
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ node colors > applies var(--graph-commit) fill to commit nodes
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ reactivity > re-renders when nodes prop changes
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ reactivity > re-renders when selectedId prop changes
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ reactivity > stops prior simulation when props change
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ directional layout bias > places higher-priority nodes closer to the top (lower Y)
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ directional layout bias > places deeper nodes further to the right (higher X)
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ large graphs > renders a large graph without errors
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ large graphs > renders a dense graph with viewBox
 âœ“ src/graph/AgentGraph.test.tsx > graphData â€“ depth and priority population > buildTaskGraph > returns empty graph for empty input
 âœ“ src/graph/AgentGraph.test.tsx > graphData â€“ depth and priority population > buildTaskGraph > creates a root agent node at depth 0 priority 4
 âœ“ src/graph/AgentGraph.test.tsx > graphData â€“ depth and priority population > buildTaskGraph > assigns depth 1 to top-level tasks
 âœ“ src/graph/AgentGraph.test.tsx > graphData â€“ depth and priority population > buildTaskGraph > increments depth for nested children
 âœ“ src/graph/AgentGraph.test.tsx > graphData â€“ depth and priority population > buildTaskGraph > maps task status to priority: in_progress > pending > completed
 âœ“ src/graph/AgentGraph.test.tsx > graphData â€“ depth and priority population > buildTaskGraph > creates links from parent to child
 âœ“ src/graph/AgentGraph.test.tsx > graphData â€“ depth and priority population > buildCommitGraph > returns empty graph for empty input
 âœ“ src/graph/AgentGraph.test.tsx > graphData â€“ depth and priority population > buildCommitGraph > creates root at depth 0 and commits at depth 1
 âœ“ src/graph/AgentGraph.test.tsx > graphData â€“ depth and priority population > buildCommitGraph > gives newer commits (earlier in array) higher priority
 âœ“ src/graph/AgentGraph.test.tsx > graphData â€“ depth and priority population > buildUnifiedGraph > merges task and commit graphs
 âœ“ src/graph/AgentGraph.test.tsx > graphData â€“ depth and priority population > buildUnifiedGraph > preserves depth and priority from both sub-graphs
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ simulation configuration > does not error during rapid mount/unmount cycles
 âœ“ src/graph/AgentGraph.test.tsx > AgentGraph â€“ simulation configuration > renders nodes at non-overlapping positions for small graphs
 âœ“ src/views/Dashboard.test.tsx > Dashboard > renders loading state initially
 âœ“ src/views/Dashboard.test.tsx > Dashboard > renders sessions list when loaded
 âœ“ src/views/Dashboard.test.tsx > Dashboard > shows request access helpers when actions are locked
 âœ“ src/views/Dashboard.test.tsx > Dashboard > renders empty list when no sessions
 âœ“ src/views/Dashboard.test.tsx > Dashboard > doesn't show guardrails panel when hidden
 âœ“ src/views/Dashboard.test.tsx > Dashboard > shows bulk action buttons always (permission checks at action time)
 âœ“ src/views/Dashboard.test.tsx > Dashboard > skips bulk actions when confirmation is declined
 âœ“ src/views/Dashboard.test.tsx > Dashboard > allows bulk actions even if they may fail (errors handled at action time)
 âœ“ src/components/Sidebar.test.tsx > Sidebar Navigation > renders the brand name
 âœ“ src/components/Sidebar.test.tsx > Sidebar Navigation > renders all primary navigation links
 âœ“ src/components/Sidebar.test.tsx > Sidebar Navigation > renders navigation icons for each route
 âœ“ src/components/Sidebar.test.tsx > Sidebar Navigation > links to correct routes
 âœ“ src/components/Sidebar.test.tsx > Sidebar Navigation > has proper ARIA label for accessibility
 âœ“ src/components/Sidebar.test.tsx > Sidebar Navigation > renders sidebar with proper semantic structure
 âœ“ src/components/Sidebar.test.tsx > Sidebar Navigation > renders navigation elements with proper classes
 âœ“ src/components/Sidebar.test.tsx > Sidebar Navigation > displays nav labels for each navigation item
 âœ“ src/utils/guardrailGuidance.test.ts > sanitizeGuardrailGuidance > strips HTML and redacts secrets
 âœ“ src/utils/guardrailGuidance.test.ts > sanitizeGuardrailGuidance > removes control characters and redacts access keys
 âœ“ src/utils/guardrailGuidance.test.ts > sanitizeGuardrailGuidance > defaults nullish input to an empty string
 âœ“ src/utils/guardrailGuidance.test.ts > sanitizeGuardrailGuidance > coerces non-string input before sanitizing
 âœ“ src/utils/guardrailGuidance.test.ts > sanitizeGuardrailStatus > sanitizes detail while preserving other fields
 âœ“ src/utils/guardrailGuidance.test.ts > sanitizeGuardrailStatus > handles non-string detail values
 âœ“ src/utils/guardrailGuidance.test.ts > sanitizePermissionsResponse > sanitizes guardrail guidance within permissions
 âœ“ src/utils/guardrailGuidance.test.ts > sanitizePermissionsResponse > defaults missing guardrails to an empty array
 âœ“ src/utils/guardrailGuidance.test.ts > sanitizePermissionsResponse > coerces guardrail detail values in permissions
 âœ“ src/views/TaskTreeView.test.tsx > TaskTreeView > renders tasks from the API
 âœ“ src/views/TaskTreeView.test.tsx > TaskTreeView > filters by role and status
 âœ“ src/views/TaskTreeView.test.tsx > TaskTreeView > keeps parents when a child matches search
 âœ“ src/views/TaskTreeView.test.tsx > TaskTreeView > starts a task session from the detail panel
 âœ“ src/components/TerminalView.test.tsx > TerminalView > renders snapshots and applies diff patches
 âœ“ src/components/TerminalView.test.tsx > TerminalView > keeps terminal output as selectable text
 âœ“ src/views/CommitHistoryView.test.tsx > CommitHistoryView > renders commit list and shows initial diff
 âœ“ src/views/CommitHistoryView.test.tsx > CommitHistoryView > updates detail when selecting a commit
 Ã— src/routes/navigation.test.tsx > Navigation Integration Tests > Keyboard Navigation > supports Enter key to navigate 1010ms
   â†’ expected "spy" to be called with arguments: [ '/tasks' ]

Received: 



Number of calls: 0


Ignored nodes: comments, script, style
[36m<html>[39m
  [36m<head />[39m
  [36m<body>[39m
    [36m<div>[39m
      [36m<a[39m
        [33mdata-testid[39m=[32m"tasks-link"[39m
        [33mhref[39m=[32m"/tasks"[39m
        [33mrole[39m=[32m"link"[39m
      [36m>[39m
        [0mTasks[0m
      [36m</a>[39m
    [36m</div>[39m
  [36m</body>[39m
[36m</html>[39m
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Keyboard Navigation > sidebar links are keyboard accessible with proper tab order
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Route State Management > maintains route state when navigating back and forth
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Route State Management > reflects current location in navigation state
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Breadcrumb Navigation > generates correct breadcrumb for root path
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Breadcrumb Navigation > generates correct breadcrumb for tasks
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Breadcrumb Navigation > generates correct breadcrumb for nested session route
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Breadcrumb Navigation > generates correct breadcrumb for task details
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Breadcrumb Navigation > handles breadcrumb navigation for extractors with details
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Active Route Highlighting > identifies active route from location pathname
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Active Route Highlighting > highlights nested routes under parent
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Active Route Highlighting > clears active state when navigating away
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Error Boundaries in Navigation > handles invalid route gracefully
 âœ“ src/routes/navigation.test.tsx > Navigation Integration Tests > Error Boundaries in Navigation > preserves state on navigation error

â¯â¯â¯â¯â¯â¯â¯ Failed Tests 1 â¯â¯â¯â¯â¯â¯â¯

 FAIL  src/routes/navigation.test.tsx > Navigation Integration Tests > Keyboard Navigation > supports Enter key to navigate
AssertionError: expected "spy" to be called with arguments: [ '/tasks' ]

Received: 



Number of calls: 0


Ignored nodes: comments, script, style
[36m<html>[39m
  [36m<head />[39m
  [36m<body>[39m
    [36m<div>[39m
      [36m<a[39m
        [33mdata-testid[39m=[32m"tasks-link"[39m
        [33mhref[39m=[32m"/tasks"[39m
        [33mrole[39m=[32m"link"[39m
      [36m>[39m
        [0mTasks[0m
      [36m</a>[39m
    [36m</div>[39m
  [36m</body>[39m
[36m</html>[39m
 â¯ src/routes/navigation.test.tsx:126:30
    124|       // Navigation should be triggered
    125|       await waitFor(() => {
    126|         expect(mockNavigate).toHaveBeenCalledWith("/tasks");
       |                              ^
    127|       });
    128|     });
 â¯ runWithExpensiveErrorDiagnosticsDisabled ../node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12
 â¯ checkCallback ../node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77
 â¯ Timeout.checkRealTimersCallback ../node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/1]â¯

 Test Files  1 failed | 9 passed (10)
      Tests  1 failed | 109 passed (110)
   Start at  22:16:33
   Duration  2.14s (transform 1.29s, setup 0ms, collect 2.46s, tests 1.96s, environment 3.85s, prepare 609ms)


 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
